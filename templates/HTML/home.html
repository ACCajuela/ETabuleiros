 <!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Star Meeple</title>
    <link rel="stylesheet" href="/media/CSS/home.css"/>
    <link rel="stylesheet" href="/media/CSS/padrao.css"/>
    <link rel="shortcut icon" href="/media/icon.png" type="image/x-icon" />
    <!-- Bootstrap CSS -->
    <link
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- jQuery (necessário para o funcionamento do carrossel) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    {% include "HTML/partials/header.html" %}

    <div class="conteudo">
      <!-- CARROSSEL LANÇAMENTOS -->
      <h2>Lançamentos</h2>
      <div class="carrossel-container">
        <a
          class="carousel-btn prev"
          href="#carouselLancamentos"
          role="button"
          data-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Anterior</span>
        </a>

        <div
          id="carouselLancamentos"
          class="carousel slide carrossel-box"
          data-ride="carousel"
        >
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img
                class="d-block w-100"
                src="midia/catan.avif"
                alt="Primeiro Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/pandemic.jpg"
                alt="Segundo Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/uno.avif"
                alt="Terceiro Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/zombiecide.jfif"
                alt="Quarto Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/theMind.jpg"
                alt="Quinto Slide"
              />
            </div>
          </div>
        </div>

        <a
          class="carousel-btn next"
          href="#carouselLancamentos"
          role="button"
          data-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Próximo</span>
        </a>
      </div>

      <!-- CARROSSEL PROMOÇÕES -->
      <h2>Promoções</h2>
      <div class="carrossel-container">
        <a
          class="carousel-btn prev"
          href="#carouselPromocoes"
          role="button"
          data-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Anterior</span>
        </a>

        <div
          id="carouselPromocoes"
          class="carousel slide carrossel-box"
          data-ride="carousel"
        >
          <div class="carousel-inner">
            <!-- slides iguais aos anteriores -->
            <div class="carousel-item active">
              <img
                class="d-block w-100"
                src="midia/catan.avif"
                alt="Primeiro Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/pandemic.jpg"
                alt="Segundo Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/uno.avif"
                alt="Terceiro Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/zombiecide.jfif"
                alt="Quarto Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/theMind.jpg"
                alt="Quinto Slide"
              />
            </div>
          </div>
        </div>

        <a
          class="carousel-btn next"
          href="#carouselPromocoes"
          role="button"
          data-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Próximo</span>
        </a>
      </div>

      <!-- CARROSSEL MAIS VENDIDOS -->
      <h2>Mais Vendidos</h2>
      <div class="carrossel-container">
        <a
          class="carousel-btn prev"
          href="#carouselRecomendados"
          role="button"
          data-slide="prev"
        >
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Anterior</span>
        </a>

        <div
          id="carouselRecomendados"
          class="carousel slide carrossel-box"
          data-ride="carousel"
        >
          <div class="carousel-inner">
            <!-- slides iguais aos anteriores -->
            <div class="carousel-item active">
              <img
                class="d-block w-100"
                src="midia/catan.avif"
                alt="Primeiro Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/pandemic.jpg"
                alt="Segundo Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/uno.avif"
                alt="Terceiro Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/zombiecide.jfif"
                alt="Quarto Slide"
              />
            </div>
            <div class="carousel-item">
              <img
                class="d-block w-100"
                src="midia/theMind.jpg"
                alt="Quinto Slide"
              />
            </div>
          </div>
        </div>

        <a
          class="carousel-btn next"
          href="#carouselRecomendados"
          role="button"
          data-slide="next"
        >
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Próximo</span>
        </a>
      </div>
    </div>

    {% include "HTML/partials/footer.html" %}
    
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const carregarCarrossel = (url, seletorCarousel, seletorErro) => {
          fetch(url)
            .then((response) => {
              if (!response.ok) {
                throw new Error(`Erro ao buscar dados de ${url}`);
              }
              return response.json();
            })
            .then((jogos) => {
              const container = document.querySelector(
                `${seletorCarousel} .carousel-inner`
              );
              container.innerHTML = "";

              if (!Array.isArray(jogos) || jogos.length === 0) {
                container.innerHTML = `
            <div class="carousel-item active text-center p-5 bg-light">
              Nenhum item disponível no momento.
            </div>
          `;
                return;
              }

              jogos.forEach((jogo, index) => {
                const ativo = index === 0 ? "active" : "";
                const imagem = jogo.imagem_url
                  ? jogo.imagem_url
                  : "/static/images/default-product.jpg";
                const item = `
            <div class="carousel-item ${ativo}">
              <img class="d-block w-100" src="${imagem}" alt="${jogo.nome}">
            </div>
          `;
                container.insertAdjacentHTML("beforeend", item);
              });
            })
            .catch((error) => {
              console.error(`Erro ao carregar dados de ${url}:`, error);
              const container = document.querySelector(
                `${seletorCarousel} .carousel-inner`
              );
              container.innerHTML = `
        <div class="carousel-item active text-center p-5 bg-light">
        Não foi possível carregar os dados.
        </div>
      `;
            });
        };

        // Chamadas para cada seção
        carregarCarrossel(
          "http://localhost:8000/api/recomendados/",
          "#carouselRecomendados",
          "#recomendados-container"
        );
        carregarCarrossel(
          "http://localhost:8000/api/lancamentos/",
          "#carouselLancamentos",
          "#lancamentos-container"
        );
        carregarCarrossel(
          "http://localhost:8000/api/promocao/",
          "#carouselPromocoes",
          "#promocoes-container"
        );
      });
    </script>
    <script src="/media/JS/home.js"></script>
    <script src="/media/JS/padrao.js"></script>
  </body>
</html>
